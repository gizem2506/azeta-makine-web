{"ast":null,"code":"import _slicedToArray from \"/Users/gizemaltay/Downloads/JWLQDZUcastro-react-construction-template-2023-11-27-05-03-28-utc/castro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"/Users/gizemaltay/Downloads/JWLQDZUcastro-react-construction-template-2023-11-27-05-03-28-utc/castro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _toConsumableArray from \"/Users/gizemaltay/Downloads/JWLQDZUcastro-react-construction-template-2023-11-27-05-03-28-utc/castro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport * as React from \"react\";\nimport { CLASS_FLEX_CENTER, CLASS_FULLSIZE, cleanup, clsx, cssClass, EVENT_ON_KEY_DOWN, EVENT_ON_POINTER_CANCEL, EVENT_ON_POINTER_DOWN, EVENT_ON_POINTER_LEAVE, EVENT_ON_POINTER_MOVE, EVENT_ON_POINTER_UP, EVENT_ON_WHEEL, ImageSlide, isImageSlide, round, useContainerRect, useController, useEventCallback, useEvents, useLayoutEffect, useLightboxState, useMotionPreference } from \"../../core/index.js\";\nimport { useZoom } from \"./ZoomContext.js\";\nimport { defaultZoomProps } from \"./Zoom.js\";\nimport { ACTION_ZOOM_IN, ACTION_ZOOM_OUT } from \"./index.js\";\nimport { isResponsiveImageSlide, ResponsiveImage } from \"./ResponsiveImage.js\";\n\nvar getSlideRects = function getSlideRects(slide, cover, maxZoomPixelRatio, rect) {\n  var _a, _b;\n\n  var slideRect = {\n    width: 0,\n    height: 0\n  };\n  var maxSlideRect = {\n    width: 0,\n    height: 0\n  };\n\n  if (rect && isImageSlide(slide)) {\n    var width = Math.max.apply(Math, _toConsumableArray((((_a = slide.srcSet) === null || _a === void 0 ? void 0 : _a.map(function (x) {\n      return x.width;\n    })) || []).concat(slide.width ? [slide.width] : [])));\n    var height = Math.max.apply(Math, _toConsumableArray((((_b = slide.srcSet) === null || _b === void 0 ? void 0 : _b.map(function (x) {\n      return x.height;\n    })) || []).concat(slide.height ? [slide.height] : [])));\n\n    if (width > 0 && height > 0 && rect.width > 0 && rect.height > 0) {\n      maxSlideRect = cover ? {\n        width: Math.round(Math.min(width, rect.width / rect.height * height)),\n        height: Math.round(Math.min(height, rect.height / rect.width * width))\n      } : {\n        width: width,\n        height: height\n      };\n      maxSlideRect = {\n        width: maxSlideRect.width * maxZoomPixelRatio,\n        height: maxSlideRect.height * maxZoomPixelRatio\n      };\n      slideRect = cover ? {\n        width: Math.min(rect.width, maxSlideRect.width),\n        height: Math.min(rect.height, maxSlideRect.height)\n      } : {\n        width: Math.round(Math.min(rect.width, rect.height / height * width)),\n        height: Math.round(Math.min(rect.height, rect.width / width * height))\n      };\n    }\n  }\n\n  return {\n    slideRect: slideRect,\n    maxSlideRect: maxSlideRect\n  };\n};\n\nvar distance = function distance(pointerA, pointerB) {\n  return Math.pow(Math.pow(pointerA.clientX - pointerB.clientX, 2) + Math.pow(pointerA.clientY - pointerB.clientY, 2), 0.5);\n};\n\nexport var ZoomContainer = function ZoomContainer(_ref) {\n  var slide = _ref.slide,\n      offset = _ref.offset,\n      rect = _ref.rect,\n      render = _ref.render,\n      carousel = _ref.carousel,\n      animation = _ref.animation,\n      originalZoomProps = _ref.zoom,\n      on = _ref.on;\n\n  var _a;\n\n  var zoomProps = _objectSpread(_objectSpread({}, defaultZoomProps), originalZoomProps);\n\n  var _useLightboxState = useLightboxState(),\n      currentIndex = _useLightboxState.state.currentIndex;\n\n  var _React$useState = React.useState(1),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      zoom = _React$useState2[0],\n      setZoom = _React$useState2[1];\n\n  var _React$useState3 = React.useState(0),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      offsetX = _React$useState4[0],\n      setOffsetX = _React$useState4[1];\n\n  var _React$useState5 = React.useState(0),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      offsetY = _React$useState6[0],\n      setOffsetY = _React$useState6[1];\n\n  var _React$useState7 = React.useState(),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      imageDimensions = _React$useState8[0],\n      setImageDimensions = _React$useState8[1];\n\n  var activePointers = React.useRef([]);\n  var lastPointerDown = React.useRef(0);\n  var zoomAnimation = React.useRef();\n  var zoomAnimationStart = React.useRef();\n  var pinchZoomDistance = React.useRef();\n\n  var _useZoom = useZoom(),\n      isMinZoom = _useZoom.isMinZoom,\n      isMaxZoom = _useZoom.isMaxZoom,\n      setIsMinZoom = _useZoom.setIsMinZoom,\n      setIsMaxZoom = _useZoom.setIsMaxZoom;\n\n  var _useContainerRect = useContainerRect(),\n      setContainerRef = _useContainerRect.setContainerRef,\n      containerRef = _useContainerRect.containerRef,\n      containerRect = _useContainerRect.containerRect;\n\n  var _useController = useController(),\n      subscribeSensors = _useController.subscribeSensors,\n      controllerRef = _useController.containerRef,\n      controllerRect = _useController.containerRect;\n\n  var _useEvents = useEvents(),\n      subscribe = _useEvents.subscribe;\n\n  var reduceMotion = useMotionPreference();\n\n  var _getSlideRects = getSlideRects(_objectSpread(_objectSpread({}, slide), imageDimensions), carousel.imageFit === \"cover\" || \"imageFit\" in slide && slide.imageFit === \"cover\", zoomProps.maxZoomPixelRatio, containerRect),\n      slideRect = _getSlideRects.slideRect,\n      currentMaxSlideRect = _getSlideRects.maxSlideRect;\n\n  var maxZoom = slideRect.width ? Math.max(round(currentMaxSlideRect.width / slideRect.width, 5), 1) : 1;\n  var changeOffsets = useEventCallback(function (dx, dy, targetZoom) {\n    var newZoom = targetZoom || zoom;\n    var newOffsetX = offsetX - (dx || 0);\n    var newOffsetY = offsetY - (dy || 0);\n    var maxOffsetX = containerRect ? (slideRect.width * newZoom - containerRect.width) / 2 / newZoom : 0;\n    var maxOffsetY = containerRect ? (slideRect.height * newZoom - containerRect.height) / 2 / newZoom : 0;\n    setOffsetX(Math.min(Math.abs(newOffsetX), Math.max(maxOffsetX, 0)) * Math.sign(newOffsetX));\n    setOffsetY(Math.min(Math.abs(newOffsetY), Math.max(maxOffsetY, 0)) * Math.sign(newOffsetY));\n  });\n  var changeZoom = useEventCallback(function (value, rapid, dx, dy) {\n    if (!containerRef.current || !containerRect) return;\n    var newZoom = round(Math.min(Math.max(value + 0.001 < maxZoom ? value : maxZoom, 1), maxZoom), 5);\n    if (newZoom === zoom) return;\n\n    if (!rapid) {\n      zoomAnimationStart.current = window.getComputedStyle(containerRef.current).transform;\n    }\n\n    changeOffsets(dx ? dx * (1 / zoom - 1 / newZoom) : 0, dy ? dy * (1 / zoom - 1 / newZoom) : 0, newZoom);\n    setZoom(newZoom);\n  });\n  var handleControllerRectChange = useEventCallback(function () {\n    if (zoom > 1) {\n      if (zoom > maxZoom) {\n        changeZoom(maxZoom, true);\n      }\n\n      changeOffsets();\n    }\n  });\n  useLayoutEffect(handleControllerRectChange, [controllerRect.width, controllerRect.height, handleControllerRectChange]);\n  var handleZoomAndOffsetChange = useEventCallback(function () {\n    var _a, _b, _c, _d;\n\n    (_a = zoomAnimation.current) === null || _a === void 0 ? void 0 : _a.cancel();\n\n    if (zoomAnimationStart.current && containerRef.current) {\n      zoomAnimation.current = (_c = (_b = containerRef.current).animate) === null || _c === void 0 ? void 0 : _c.call(_b, [{\n        transform: zoomAnimationStart.current\n      }, {\n        transform: \"scale(\".concat(zoom, \") translateX(\").concat(offsetX, \"px) translateY(\").concat(offsetY, \"px)\")\n      }], {\n        duration: reduceMotion ? 0 : (_d = animation.zoom) !== null && _d !== void 0 ? _d : 500,\n        easing: zoomAnimation ? \"ease-out\" : \"ease-in-out\"\n      });\n      zoomAnimationStart.current = undefined;\n\n      if (zoomAnimation.current) {\n        zoomAnimation.current.onfinish = function () {\n          zoomAnimation.current = undefined;\n        };\n      }\n    }\n  });\n  useLayoutEffect(handleZoomAndOffsetChange, [zoom, offsetX, offsetY, handleZoomAndOffsetChange]);\n  useLayoutEffect(function () {\n    if (offset === 0) {\n      var resetZoom = function resetZoom() {\n        setZoom(1);\n        setOffsetX(0);\n        setOffsetY(0);\n        setIsMinZoom(true);\n        setIsMaxZoom(false);\n      };\n\n      resetZoom();\n      return function () {\n        resetZoom();\n      };\n    }\n\n    return function () {};\n  }, [offset, setIsMinZoom, setIsMaxZoom]);\n  useLayoutEffect(function () {\n    if (offset === 0) {\n      var newMinZoom = zoom <= 1;\n\n      if (newMinZoom !== isMinZoom) {\n        setIsMinZoom(newMinZoom);\n      }\n\n      var newMaxZoom = zoom >= maxZoom;\n\n      if (newMaxZoom !== isMaxZoom) {\n        setIsMaxZoom(newMaxZoom);\n      }\n    }\n  }, [offset, zoom, maxZoom, isMinZoom, isMaxZoom, setIsMinZoom, setIsMaxZoom]);\n  var translateCoordinates = React.useCallback(function (event) {\n    if (controllerRef.current) {\n      var pageX = event.pageX,\n          pageY = event.pageY;\n      var _window = window,\n          scrollX = _window.scrollX,\n          scrollY = _window.scrollY;\n\n      var _controllerRef$curren = controllerRef.current.getBoundingClientRect(),\n          left = _controllerRef$curren.left,\n          top = _controllerRef$curren.top,\n          width = _controllerRef$curren.width,\n          height = _controllerRef$curren.height;\n\n      return [pageX - left - scrollX - width / 2, pageY - top - scrollY - height / 2];\n    }\n\n    return [];\n  }, [controllerRef]);\n  var onKeyDown = useEventCallback(function (event) {\n    var keyboardMoveDistance = zoomProps.keyboardMoveDistance,\n        zoomInMultiplier = zoomProps.zoomInMultiplier;\n\n    var preventDefault = function preventDefault() {\n      event.preventDefault();\n      event.stopPropagation();\n    };\n\n    if (zoom > 1) {\n      var move = function move(deltaX, deltaY) {\n        preventDefault();\n        changeOffsets(deltaX, deltaY);\n      };\n\n      if (event.key === \"ArrowDown\") {\n        move(0, keyboardMoveDistance);\n      } else if (event.key === \"ArrowUp\") {\n        move(0, -keyboardMoveDistance);\n      } else if (event.key === \"ArrowLeft\") {\n        move(-keyboardMoveDistance, 0);\n      } else if (event.key === \"ArrowRight\") {\n        move(keyboardMoveDistance, 0);\n      }\n    }\n\n    var handleChangeZoom = function handleChangeZoom(zoomValue) {\n      preventDefault();\n      changeZoom(zoomValue);\n    };\n\n    var hasMeta = function hasMeta() {\n      return event.getModifierState(\"Meta\") || event.getModifierState(\"OS\");\n    };\n\n    if (event.key === \"+\" || event.key === \"=\" && hasMeta()) {\n      handleChangeZoom(zoom * zoomInMultiplier);\n    } else if (event.key === \"-\" || event.key === \"_\" && hasMeta()) {\n      handleChangeZoom(zoom / zoomInMultiplier);\n    } else if (event.key === \"0\" && hasMeta()) {\n      handleChangeZoom(1);\n    }\n  });\n  var onWheel = useEventCallback(function (event) {\n    var wheelZoomDistanceFactor = zoomProps.wheelZoomDistanceFactor,\n        scrollToZoom = zoomProps.scrollToZoom;\n\n    if (event.ctrlKey || scrollToZoom) {\n      if (Math.abs(event.deltaY) > Math.abs(event.deltaX)) {\n        event.stopPropagation();\n        changeZoom.apply(void 0, [zoom * (1 - event.deltaY / wheelZoomDistanceFactor), true].concat(_toConsumableArray(translateCoordinates(event))));\n        return;\n      }\n    }\n\n    if (zoom > 1) {\n      event.stopPropagation();\n\n      if (!scrollToZoom) {\n        changeOffsets(event.deltaX, event.deltaY);\n      }\n    }\n  });\n  var clearPointer = React.useCallback(function (event) {\n    var pointers = activePointers.current;\n    pointers.splice.apply(pointers, [0, pointers.length].concat(_toConsumableArray(pointers.filter(function (p) {\n      return p.pointerId !== event.pointerId;\n    }))));\n  }, []);\n  var replacePointer = React.useCallback(function (event) {\n    clearPointer(event);\n    activePointers.current.push(event);\n  }, [clearPointer]);\n  var onPointerDown = useEventCallback(function (event) {\n    var _a;\n\n    var doubleTapDelay = zoomProps.doubleTapDelay,\n        doubleClickDelay = zoomProps.doubleClickDelay,\n        zoomInMultiplier = zoomProps.zoomInMultiplier,\n        doubleClickMaxStops = zoomProps.doubleClickMaxStops;\n    var pointers = activePointers.current;\n\n    if (!((_a = containerRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.target))) {\n      return;\n    }\n\n    if (zoom > 1) {\n      event.stopPropagation();\n    }\n\n    var timeStamp = event.timeStamp;\n\n    if (pointers.length === 0 && timeStamp - lastPointerDown.current < (event.pointerType === \"touch\" ? doubleTapDelay : doubleClickDelay)) {\n      lastPointerDown.current = 0;\n      changeZoom.apply(void 0, [zoom !== maxZoom ? zoom * Math.max(Math.pow(maxZoom, 1 / doubleClickMaxStops), zoomInMultiplier) : 1, false].concat(_toConsumableArray(translateCoordinates(event))));\n    } else {\n      lastPointerDown.current = timeStamp;\n    }\n\n    replacePointer(event);\n\n    if (pointers.length === 2) {\n      pinchZoomDistance.current = distance(pointers[0], pointers[1]);\n    }\n  });\n  var onPointerMove = useEventCallback(function (event) {\n    var pointers = activePointers.current;\n    var activePointer = pointers.find(function (p) {\n      return p.pointerId === event.pointerId;\n    });\n\n    if (pointers.length === 2 && pinchZoomDistance.current) {\n      event.stopPropagation();\n      replacePointer(event);\n      var currentDistance = distance(pointers[0], pointers[1]);\n      var delta = currentDistance - pinchZoomDistance.current;\n\n      if (Math.abs(delta) > 0) {\n        changeZoom.apply(void 0, [zoom * (1 + delta / zoomProps.pinchZoomDistanceFactor), true].concat(_toConsumableArray(pointers.map(function (x) {\n          return translateCoordinates(x);\n        }).reduce(function (acc, coordinate) {\n          return coordinate.map(function (x, i) {\n            return acc[i] + x / 2;\n          });\n        }))));\n        pinchZoomDistance.current = currentDistance;\n      }\n\n      return;\n    }\n\n    if (zoom > 1) {\n      event.stopPropagation();\n\n      if (activePointer) {\n        if (pointers.length === 1) {\n          changeOffsets((activePointer.clientX - event.clientX) / zoom, (activePointer.clientY - event.clientY) / zoom);\n        }\n\n        replacePointer(event);\n      }\n    }\n  });\n  var onPointerUp = React.useCallback(function (event) {\n    var pointers = activePointers.current;\n\n    if (pointers.length === 2 && pointers.find(function (p) {\n      return p.pointerId === event.pointerId;\n    })) {\n      pinchZoomDistance.current = undefined;\n    }\n\n    clearPointer(event);\n  }, [clearPointer]);\n  var handleZoomIn = useEventCallback(function () {\n    changeZoom(zoom * zoomProps.zoomInMultiplier);\n  });\n  var handleZoomOut = useEventCallback(function () {\n    changeZoom(zoom / zoomProps.zoomInMultiplier);\n  });\n  React.useEffect(function () {\n    return offset === 0 ? cleanup(subscribe(ACTION_ZOOM_IN, handleZoomIn), subscribe(ACTION_ZOOM_OUT, handleZoomOut), subscribeSensors(EVENT_ON_KEY_DOWN, onKeyDown), subscribeSensors(EVENT_ON_WHEEL, onWheel), subscribeSensors(EVENT_ON_POINTER_DOWN, onPointerDown), subscribeSensors(EVENT_ON_POINTER_MOVE, onPointerMove), subscribeSensors(EVENT_ON_POINTER_UP, onPointerUp), subscribeSensors(EVENT_ON_POINTER_LEAVE, onPointerUp), subscribeSensors(EVENT_ON_POINTER_CANCEL, onPointerUp)) : function () {};\n  }, [offset, subscribe, subscribeSensors, onKeyDown, onPointerDown, onPointerMove, onPointerUp, onWheel, changeZoom, handleZoomIn, handleZoomOut]);\n  var scaledRect = offset === 0 ? {\n    width: rect.width * zoom,\n    height: rect.height * zoom\n  } : rect;\n  var rendered = (_a = render.slide) === null || _a === void 0 ? void 0 : _a.call(render, slide, offset, scaledRect);\n\n  if (!rendered && isImageSlide(slide)) {\n    var slideProps = {\n      slide: slide,\n      offset: offset,\n      rect: rect,\n      render: render,\n      imageFit: carousel.imageFit,\n      onClick: offset === 0 ? function () {\n        var _a;\n\n        return (_a = on.click) === null || _a === void 0 ? void 0 : _a.call(on, currentIndex);\n      } : undefined\n    };\n    rendered = isResponsiveImageSlide(slide) ? React.createElement(ResponsiveImage, _objectSpread(_objectSpread({}, slideProps), {}, {\n      slide: slide,\n      rect: scaledRect\n    })) : React.createElement(ImageSlide, _objectSpread({\n      onLoad: function onLoad(img) {\n        return setImageDimensions({\n          width: img.naturalWidth,\n          height: img.naturalHeight\n        });\n      }\n    }, slideProps));\n  }\n\n  return rendered ? React.createElement(\"div\", _objectSpread({\n    ref: setContainerRef,\n    className: clsx(cssClass(CLASS_FULLSIZE), cssClass(CLASS_FLEX_CENTER))\n  }, offset === 0 ? {\n    style: {\n      transform: \"scale(\".concat(zoom, \") translateX(\").concat(offsetX, \"px) translateY(\").concat(offsetY, \"px)\")\n    }\n  } : null), rendered) : null;\n};","map":{"version":3,"names":["React","CLASS_FLEX_CENTER","CLASS_FULLSIZE","cleanup","clsx","cssClass","EVENT_ON_KEY_DOWN","EVENT_ON_POINTER_CANCEL","EVENT_ON_POINTER_DOWN","EVENT_ON_POINTER_LEAVE","EVENT_ON_POINTER_MOVE","EVENT_ON_POINTER_UP","EVENT_ON_WHEEL","ImageSlide","isImageSlide","round","useContainerRect","useController","useEventCallback","useEvents","useLayoutEffect","useLightboxState","useMotionPreference","useZoom","defaultZoomProps","ACTION_ZOOM_IN","ACTION_ZOOM_OUT","isResponsiveImageSlide","ResponsiveImage","getSlideRects","slide","cover","maxZoomPixelRatio","rect","_a","_b","slideRect","width","height","maxSlideRect","Math","max","srcSet","map","x","concat","min","distance","pointerA","pointerB","clientX","clientY","ZoomContainer","offset","render","carousel","animation","originalZoomProps","zoom","on","zoomProps","currentIndex","state","useState","setZoom","offsetX","setOffsetX","offsetY","setOffsetY","imageDimensions","setImageDimensions","activePointers","useRef","lastPointerDown","zoomAnimation","zoomAnimationStart","pinchZoomDistance","isMinZoom","isMaxZoom","setIsMinZoom","setIsMaxZoom","setContainerRef","containerRef","containerRect","subscribeSensors","controllerRef","controllerRect","subscribe","reduceMotion","imageFit","currentMaxSlideRect","maxZoom","changeOffsets","dx","dy","targetZoom","newZoom","newOffsetX","newOffsetY","maxOffsetX","maxOffsetY","abs","sign","changeZoom","value","rapid","current","window","getComputedStyle","transform","handleControllerRectChange","handleZoomAndOffsetChange","_c","_d","cancel","animate","call","duration","easing","undefined","onfinish","resetZoom","newMinZoom","newMaxZoom","translateCoordinates","useCallback","event","pageX","pageY","scrollX","scrollY","getBoundingClientRect","left","top","onKeyDown","keyboardMoveDistance","zoomInMultiplier","preventDefault","stopPropagation","move","deltaX","deltaY","key","handleChangeZoom","zoomValue","hasMeta","getModifierState","onWheel","wheelZoomDistanceFactor","scrollToZoom","ctrlKey","clearPointer","pointers","splice","length","filter","p","pointerId","replacePointer","push","onPointerDown","doubleTapDelay","doubleClickDelay","doubleClickMaxStops","contains","target","timeStamp","pointerType","onPointerMove","activePointer","find","currentDistance","delta","pinchZoomDistanceFactor","reduce","acc","coordinate","i","onPointerUp","handleZoomIn","handleZoomOut","useEffect","scaledRect","rendered","slideProps","onClick","click","createElement","onLoad","img","naturalWidth","naturalHeight","ref","className","style"],"sources":["/Users/gizemaltay/Downloads/JWLQDZUcastro-react-construction-template-2023-11-27-05-03-28-utc/castro/node_modules/yet-another-react-lightbox/dist/plugins/zoom/ZoomContainer.js"],"sourcesContent":["import * as React from \"react\";\nimport { CLASS_FLEX_CENTER, CLASS_FULLSIZE, cleanup, clsx, cssClass, EVENT_ON_KEY_DOWN, EVENT_ON_POINTER_CANCEL, EVENT_ON_POINTER_DOWN, EVENT_ON_POINTER_LEAVE, EVENT_ON_POINTER_MOVE, EVENT_ON_POINTER_UP, EVENT_ON_WHEEL, ImageSlide, isImageSlide, round, useContainerRect, useController, useEventCallback, useEvents, useLayoutEffect, useLightboxState, useMotionPreference, } from \"../../core/index.js\";\nimport { useZoom } from \"./ZoomContext.js\";\nimport { defaultZoomProps } from \"./Zoom.js\";\nimport { ACTION_ZOOM_IN, ACTION_ZOOM_OUT } from \"./index.js\";\nimport { isResponsiveImageSlide, ResponsiveImage } from \"./ResponsiveImage.js\";\nconst getSlideRects = (slide, cover, maxZoomPixelRatio, rect) => {\n    var _a, _b;\n    let slideRect = { width: 0, height: 0 };\n    let maxSlideRect = { width: 0, height: 0 };\n    if (rect && isImageSlide(slide)) {\n        const width = Math.max(...(((_a = slide.srcSet) === null || _a === void 0 ? void 0 : _a.map((x) => x.width)) || []).concat(slide.width ? [slide.width] : []));\n        const height = Math.max(...(((_b = slide.srcSet) === null || _b === void 0 ? void 0 : _b.map((x) => x.height)) || []).concat(slide.height ? [slide.height] : []));\n        if (width > 0 && height > 0 && rect.width > 0 && rect.height > 0) {\n            maxSlideRect = cover\n                ? {\n                    width: Math.round(Math.min(width, (rect.width / rect.height) * height)),\n                    height: Math.round(Math.min(height, (rect.height / rect.width) * width)),\n                }\n                : { width, height };\n            maxSlideRect = {\n                width: maxSlideRect.width * maxZoomPixelRatio,\n                height: maxSlideRect.height * maxZoomPixelRatio,\n            };\n            slideRect = cover\n                ? {\n                    width: Math.min(rect.width, maxSlideRect.width),\n                    height: Math.min(rect.height, maxSlideRect.height),\n                }\n                : {\n                    width: Math.round(Math.min(rect.width, (rect.height / height) * width)),\n                    height: Math.round(Math.min(rect.height, (rect.width / width) * height)),\n                };\n        }\n    }\n    return { slideRect, maxSlideRect };\n};\nconst distance = (pointerA, pointerB) => ((pointerA.clientX - pointerB.clientX) ** 2 + (pointerA.clientY - pointerB.clientY) ** 2) ** 0.5;\nexport const ZoomContainer = ({ slide, offset, rect, render, carousel, animation, zoom: originalZoomProps, on }) => {\n    var _a;\n    const zoomProps = { ...defaultZoomProps, ...originalZoomProps };\n    const { state: { currentIndex }, } = useLightboxState();\n    const [zoom, setZoom] = React.useState(1);\n    const [offsetX, setOffsetX] = React.useState(0);\n    const [offsetY, setOffsetY] = React.useState(0);\n    const [imageDimensions, setImageDimensions] = React.useState();\n    const activePointers = React.useRef([]);\n    const lastPointerDown = React.useRef(0);\n    const zoomAnimation = React.useRef();\n    const zoomAnimationStart = React.useRef();\n    const pinchZoomDistance = React.useRef();\n    const { isMinZoom, isMaxZoom, setIsMinZoom, setIsMaxZoom } = useZoom();\n    const { setContainerRef, containerRef, containerRect } = useContainerRect();\n    const { subscribeSensors, containerRef: controllerRef, containerRect: controllerRect } = useController();\n    const { subscribe } = useEvents();\n    const reduceMotion = useMotionPreference();\n    const { slideRect, maxSlideRect: currentMaxSlideRect } = getSlideRects({ ...slide, ...imageDimensions }, carousel.imageFit === \"cover\" || (\"imageFit\" in slide && slide.imageFit === \"cover\"), zoomProps.maxZoomPixelRatio, containerRect);\n    const maxZoom = slideRect.width ? Math.max(round(currentMaxSlideRect.width / slideRect.width, 5), 1) : 1;\n    const changeOffsets = useEventCallback((dx, dy, targetZoom) => {\n        const newZoom = targetZoom || zoom;\n        const newOffsetX = offsetX - (dx || 0);\n        const newOffsetY = offsetY - (dy || 0);\n        const maxOffsetX = containerRect ? (slideRect.width * newZoom - containerRect.width) / 2 / newZoom : 0;\n        const maxOffsetY = containerRect ? (slideRect.height * newZoom - containerRect.height) / 2 / newZoom : 0;\n        setOffsetX(Math.min(Math.abs(newOffsetX), Math.max(maxOffsetX, 0)) * Math.sign(newOffsetX));\n        setOffsetY(Math.min(Math.abs(newOffsetY), Math.max(maxOffsetY, 0)) * Math.sign(newOffsetY));\n    });\n    const changeZoom = useEventCallback((value, rapid, dx, dy) => {\n        if (!containerRef.current || !containerRect)\n            return;\n        const newZoom = round(Math.min(Math.max(value + 0.001 < maxZoom ? value : maxZoom, 1), maxZoom), 5);\n        if (newZoom === zoom)\n            return;\n        if (!rapid) {\n            zoomAnimationStart.current = window.getComputedStyle(containerRef.current).transform;\n        }\n        changeOffsets(dx ? dx * (1 / zoom - 1 / newZoom) : 0, dy ? dy * (1 / zoom - 1 / newZoom) : 0, newZoom);\n        setZoom(newZoom);\n    });\n    const handleControllerRectChange = useEventCallback(() => {\n        if (zoom > 1) {\n            if (zoom > maxZoom) {\n                changeZoom(maxZoom, true);\n            }\n            changeOffsets();\n        }\n    });\n    useLayoutEffect(handleControllerRectChange, [\n        controllerRect.width,\n        controllerRect.height,\n        handleControllerRectChange,\n    ]);\n    const handleZoomAndOffsetChange = useEventCallback(() => {\n        var _a, _b, _c, _d;\n        (_a = zoomAnimation.current) === null || _a === void 0 ? void 0 : _a.cancel();\n        if (zoomAnimationStart.current && containerRef.current) {\n            zoomAnimation.current = (_c = (_b = containerRef.current).animate) === null || _c === void 0 ? void 0 : _c.call(_b, [\n                { transform: zoomAnimationStart.current },\n                {\n                    transform: `scale(${zoom}) translateX(${offsetX}px) translateY(${offsetY}px)`,\n                },\n            ], {\n                duration: reduceMotion ? 0 : (_d = animation.zoom) !== null && _d !== void 0 ? _d : 500,\n                easing: zoomAnimation ? \"ease-out\" : \"ease-in-out\",\n            });\n            zoomAnimationStart.current = undefined;\n            if (zoomAnimation.current) {\n                zoomAnimation.current.onfinish = () => {\n                    zoomAnimation.current = undefined;\n                };\n            }\n        }\n    });\n    useLayoutEffect(handleZoomAndOffsetChange, [zoom, offsetX, offsetY, handleZoomAndOffsetChange]);\n    useLayoutEffect(() => {\n        if (offset === 0) {\n            const resetZoom = () => {\n                setZoom(1);\n                setOffsetX(0);\n                setOffsetY(0);\n                setIsMinZoom(true);\n                setIsMaxZoom(false);\n            };\n            resetZoom();\n            return () => {\n                resetZoom();\n            };\n        }\n        return () => { };\n    }, [offset, setIsMinZoom, setIsMaxZoom]);\n    useLayoutEffect(() => {\n        if (offset === 0) {\n            const newMinZoom = zoom <= 1;\n            if (newMinZoom !== isMinZoom) {\n                setIsMinZoom(newMinZoom);\n            }\n            const newMaxZoom = zoom >= maxZoom;\n            if (newMaxZoom !== isMaxZoom) {\n                setIsMaxZoom(newMaxZoom);\n            }\n        }\n    }, [offset, zoom, maxZoom, isMinZoom, isMaxZoom, setIsMinZoom, setIsMaxZoom]);\n    const translateCoordinates = React.useCallback((event) => {\n        if (controllerRef.current) {\n            const { pageX, pageY } = event;\n            const { scrollX, scrollY } = window;\n            const { left, top, width, height } = controllerRef.current.getBoundingClientRect();\n            return [pageX - left - scrollX - width / 2, pageY - top - scrollY - height / 2];\n        }\n        return [];\n    }, [controllerRef]);\n    const onKeyDown = useEventCallback((event) => {\n        const { keyboardMoveDistance, zoomInMultiplier } = zoomProps;\n        const preventDefault = () => {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n        if (zoom > 1) {\n            const move = (deltaX, deltaY) => {\n                preventDefault();\n                changeOffsets(deltaX, deltaY);\n            };\n            if (event.key === \"ArrowDown\") {\n                move(0, keyboardMoveDistance);\n            }\n            else if (event.key === \"ArrowUp\") {\n                move(0, -keyboardMoveDistance);\n            }\n            else if (event.key === \"ArrowLeft\") {\n                move(-keyboardMoveDistance, 0);\n            }\n            else if (event.key === \"ArrowRight\") {\n                move(keyboardMoveDistance, 0);\n            }\n        }\n        const handleChangeZoom = (zoomValue) => {\n            preventDefault();\n            changeZoom(zoomValue);\n        };\n        const hasMeta = () => event.getModifierState(\"Meta\") || event.getModifierState(\"OS\");\n        if (event.key === \"+\" || (event.key === \"=\" && hasMeta())) {\n            handleChangeZoom(zoom * zoomInMultiplier);\n        }\n        else if (event.key === \"-\" || (event.key === \"_\" && hasMeta())) {\n            handleChangeZoom(zoom / zoomInMultiplier);\n        }\n        else if (event.key === \"0\" && hasMeta()) {\n            handleChangeZoom(1);\n        }\n    });\n    const onWheel = useEventCallback((event) => {\n        const { wheelZoomDistanceFactor, scrollToZoom } = zoomProps;\n        if (event.ctrlKey || scrollToZoom) {\n            if (Math.abs(event.deltaY) > Math.abs(event.deltaX)) {\n                event.stopPropagation();\n                changeZoom(zoom * (1 - event.deltaY / wheelZoomDistanceFactor), true, ...translateCoordinates(event));\n                return;\n            }\n        }\n        if (zoom > 1) {\n            event.stopPropagation();\n            if (!scrollToZoom) {\n                changeOffsets(event.deltaX, event.deltaY);\n            }\n        }\n    });\n    const clearPointer = React.useCallback((event) => {\n        const pointers = activePointers.current;\n        pointers.splice(0, pointers.length, ...pointers.filter((p) => p.pointerId !== event.pointerId));\n    }, []);\n    const replacePointer = React.useCallback((event) => {\n        clearPointer(event);\n        activePointers.current.push(event);\n    }, [clearPointer]);\n    const onPointerDown = useEventCallback((event) => {\n        var _a;\n        const { doubleTapDelay, doubleClickDelay, zoomInMultiplier, doubleClickMaxStops } = zoomProps;\n        const pointers = activePointers.current;\n        if (!((_a = containerRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.target))) {\n            return;\n        }\n        if (zoom > 1) {\n            event.stopPropagation();\n        }\n        const { timeStamp } = event;\n        if (pointers.length === 0 &&\n            timeStamp - lastPointerDown.current < (event.pointerType === \"touch\" ? doubleTapDelay : doubleClickDelay)) {\n            lastPointerDown.current = 0;\n            changeZoom(zoom !== maxZoom ? zoom * Math.max(maxZoom ** (1 / doubleClickMaxStops), zoomInMultiplier) : 1, false, ...translateCoordinates(event));\n        }\n        else {\n            lastPointerDown.current = timeStamp;\n        }\n        replacePointer(event);\n        if (pointers.length === 2) {\n            pinchZoomDistance.current = distance(pointers[0], pointers[1]);\n        }\n    });\n    const onPointerMove = useEventCallback((event) => {\n        const pointers = activePointers.current;\n        const activePointer = pointers.find((p) => p.pointerId === event.pointerId);\n        if (pointers.length === 2 && pinchZoomDistance.current) {\n            event.stopPropagation();\n            replacePointer(event);\n            const currentDistance = distance(pointers[0], pointers[1]);\n            const delta = currentDistance - pinchZoomDistance.current;\n            if (Math.abs(delta) > 0) {\n                changeZoom(zoom * (1 + delta / zoomProps.pinchZoomDistanceFactor), true, ...pointers\n                    .map((x) => translateCoordinates(x))\n                    .reduce((acc, coordinate) => coordinate.map((x, i) => acc[i] + x / 2)));\n                pinchZoomDistance.current = currentDistance;\n            }\n            return;\n        }\n        if (zoom > 1) {\n            event.stopPropagation();\n            if (activePointer) {\n                if (pointers.length === 1) {\n                    changeOffsets((activePointer.clientX - event.clientX) / zoom, (activePointer.clientY - event.clientY) / zoom);\n                }\n                replacePointer(event);\n            }\n        }\n    });\n    const onPointerUp = React.useCallback((event) => {\n        const pointers = activePointers.current;\n        if (pointers.length === 2 && pointers.find((p) => p.pointerId === event.pointerId)) {\n            pinchZoomDistance.current = undefined;\n        }\n        clearPointer(event);\n    }, [clearPointer]);\n    const handleZoomIn = useEventCallback(() => {\n        changeZoom(zoom * zoomProps.zoomInMultiplier);\n    });\n    const handleZoomOut = useEventCallback(() => {\n        changeZoom(zoom / zoomProps.zoomInMultiplier);\n    });\n    React.useEffect(() => offset === 0\n        ? cleanup(subscribe(ACTION_ZOOM_IN, handleZoomIn), subscribe(ACTION_ZOOM_OUT, handleZoomOut), subscribeSensors(EVENT_ON_KEY_DOWN, onKeyDown), subscribeSensors(EVENT_ON_WHEEL, onWheel), subscribeSensors(EVENT_ON_POINTER_DOWN, onPointerDown), subscribeSensors(EVENT_ON_POINTER_MOVE, onPointerMove), subscribeSensors(EVENT_ON_POINTER_UP, onPointerUp), subscribeSensors(EVENT_ON_POINTER_LEAVE, onPointerUp), subscribeSensors(EVENT_ON_POINTER_CANCEL, onPointerUp))\n        : () => { }, [\n        offset,\n        subscribe,\n        subscribeSensors,\n        onKeyDown,\n        onPointerDown,\n        onPointerMove,\n        onPointerUp,\n        onWheel,\n        changeZoom,\n        handleZoomIn,\n        handleZoomOut,\n    ]);\n    const scaledRect = offset === 0\n        ? {\n            width: rect.width * zoom,\n            height: rect.height * zoom,\n        }\n        : rect;\n    let rendered = (_a = render.slide) === null || _a === void 0 ? void 0 : _a.call(render, slide, offset, scaledRect);\n    if (!rendered && isImageSlide(slide)) {\n        const slideProps = {\n            slide,\n            offset,\n            rect,\n            render,\n            imageFit: carousel.imageFit,\n            onClick: offset === 0 ? () => { var _a; return (_a = on.click) === null || _a === void 0 ? void 0 : _a.call(on, currentIndex); } : undefined,\n        };\n        rendered = isResponsiveImageSlide(slide) ? (React.createElement(ResponsiveImage, { ...slideProps, slide: slide, rect: scaledRect })) : (React.createElement(ImageSlide, { onLoad: (img) => setImageDimensions({ width: img.naturalWidth, height: img.naturalHeight }), ...slideProps }));\n    }\n    return rendered ? (React.createElement(\"div\", { ref: setContainerRef, className: clsx(cssClass(CLASS_FULLSIZE), cssClass(CLASS_FLEX_CENTER)), ...(offset === 0\n            ? { style: { transform: `scale(${zoom}) translateX(${offsetX}px) translateY(${offsetY}px)` } }\n            : null) }, rendered)) : null;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}